(this.webpackJsonpgame1=this.webpackJsonpgame1||[]).push([[0],{113:function(e,t,a){e.exports=a(158)},118:function(e,t,a){},119:function(e,t,a){},158:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(23),r=a.n(i),c=(a(118),a(38)),s=a(39),l=a(19),u=a(46),p=a(45),m=(a(119),a(13)),d=(a(130),a(36)),b=a.n(d),f=b.a.initializeApp({apiKey:"AIzaSyCU3lAPlsxkBORPy2HQfCdayJNIIh0PrV4",authDomain:"game1-cae49.firebaseapp.com",databaseURL:"https://game1-cae49.firebaseio.com",projectId:"game1-cae49",storageBucket:"game1-cae49.appspot.com",messagingSenderId:"691468574984",appId:"1:691468574984:web:1c76454a2ec3020e820cbd",measurementId:"G-1B23MNQTH4"});b.a.analytics();var h=f,g=a(37),v=a.n(g),k=a(42),y=function(){var e=Object(k.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={id:t,warPoints:0,lastTaken:+new Date},h.firestore().collection("users").doc(t.toString()).get().then((function(e){e.exists||h.firestore().collection("users").doc(t.toString()).set(a).then((function(e){console.log("Created user..."),window.location.reload()}))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=a(20),C=a.n(w),E=a(30),S=a.n(E),I=function(e){var t=null,a=[];return location.search.substr(1).split("&").forEach((function(n){(a=n.split("="))[0]===e&&(t=decodeURIComponent(a[1]))})),t},_=a(22),x=a(24),P=a.n(x),O=a(34),D=a.n(O),T=a(35),j=a.n(T),z=a(43),B=a.n(z),R=a(44),V=a.n(R),A=function(e){return o.a.createElement("div",{id:"layout"},o.a.createElement("div",{id:"layoutBG",style:{backgroundImage:"url("+e.data.background+")",width:"100%",height:"30vh",backgroundAttachment:"scroll",backgroundClip:"border-box",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}}),o.a.createElement(m.c,{className:"layoutName"},e.data.name),o.a.createElement(m.g,{before:o.a.createElement(j.a,null)},e.data.description),o.a.createElement(m.g,{before:o.a.createElement(m.b,{size:48,src:e.owner.photo_200}),description:"\u0412\u043b\u0430\u0434\u0435\u043b\u0435\u0446"},e.owner.first_name+" "+e.owner.last_name),o.a.createElement(m.g,{onClick:e.buy,multiline:!0,before:o.a.createElement("img",{src:P.a,alt:"\u043f\u0435\u0432\u043a\u043e",width:24,height:24}),expandable:!0},"\u0420\u0430\u0431\u043e\u0442\u044f\u0433 \u043c\u043e\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u043a\u0443\u043f\u0438\u0442\u044c \u0437\u0430 ",e.data.value," \u043f\u0438\u0432\u0430"),o.a.createElement("div",{onClick:function(){S()("#layout").removeClass("active")},style:{position:"absolute",bottom:15,left:"calc(50% - 36px)",boxShadow:"2px 2px 10px -1px rgba(0,0,0,0.55)",padding:10,borderRadius:25}},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"))},M=function(e){return o.a.createElement(_.Map,{onReady:function(t,a){return e.removeIcons(t,a)},style:{width:"100%",height:"calc(100vh - 57px)"},google:e.google,zoom:14,streetViewControl:!1,mapTypeControl:!1,scaleControl:!1,fullscreenControl:!1,zoomControl:!1,initialCenter:{lat:54.77927,lng:56.123964}},o.a.createElement(_.Marker,{num:1488,title:"\u0421\u043a\u043b\u0430\u0434 \u043f\u0435\u0432\u043a\u0430",name:"\u0421\u043a\u043b\u0430\u0434 \u043f\u0435\u0432\u043a\u0430",background:"",description:"",onClick:e.markerClick,position:{lat:54.777251,lng:56.127483},icon:{url:D.a,anchor:new google.maps.Point(32,32),scaledSize:new google.maps.Size(32,32)}}),e.points.map((function(t){return o.a.createElement(_.Marker,{key:t.name+t.lat,num:t.id,title:t.name,name:t.name,background:t.background,description:t.description,onClick:e.markerClick,position:{lat:t.lat,lng:t.lon},icon:{url:P.a}})})))},U=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={activeView:"main",activePanel:"main",VK_UID:0,userData:{id:0,warPoints:0},popout:"",modal:"",snackbar:"",activeTab:0,activeTabOwner:{first_name:"\u041c\u0443\u0436\u0438\u043a",last_name:"\u0422\u0430\u0434\u0436\u0438\u043a",photo_200:"https://sun9-60.userapi.com/c849532/v849532674/13d845/_Rsu5onfz-c.jpg"},points:[{name:"\u041f\u044f\u0442\u0430\u0447\u043e\u043a",value:5,lat:54.791769,lon:56.086817,owner:0,background:"https://firebasestorage.googleapis.com/v0/b/game1-cae49.appspot.com/o/inorsBG%2F%D0%BF%D1%8F%D1%82%D0%B0%D0%BA.png?alt=media&token=e27c9707-bdb0-4dcf-96ec-586d00fea6eb",description:"\u0430\u0443\u0435"}]},n.openPanel=n.openPanel.bind(Object(l.a)(n)),n.markerClick=n.markerClick.bind(Object(l.a)(n)),n.openCaptureModal=n.openCaptureModal.bind(Object(l.a)(n)),n.kupitRabotyag=n.kupitRabotyag.bind(Object(l.a)(n)),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({VK_UID:I("vk_user_id")}),C.a.send("VKWebAppInit",{}).then((function(){return console.log("\u0412\u041a \u041f\u041e\u0414\u041a\u041b\u042e\u0427\u0415\u041d")})),y(I("vk_user_id")).then((function(){h.firestore().collection("users").doc(I("vk_user_id").toString()).onSnapshot((function(t){e.setState({userData:t.data()})})),h.firestore().collection("data").doc("points").onSnapshot((function(t){t.data()&&e.setState({points:t.data().main})}))}))}},{key:"componentWillUnmount",value:function(){}},{key:"kupitRabotyag",value:function(){var e=this,t=o.a.createElement(m.h,{layout:"vertical",onClose:function(){return e.setState({snackbar:null})},before:o.a.createElement(m.b,{size:24,style:{backgroundColor:"var(--accent)"}},o.a.createElement(B.a,{fill:"#fff",width:14,height:14}))},"\u0420\u0430\u0431\u043e\u0442\u044f\u0433\u0438 \u0442\u0435\u043f\u0435\u0440\u044c \u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0442 \u043f\u0435\u0432\u043a\u043e \u0432\u0430\u043c"),a=o.a.createElement(m.h,{layout:"vertical",onClose:function(){return e.setState({snackbar:null})},before:o.a.createElement(m.b,{size:24,style:{backgroundColor:"var(--field_error_border)"}},o.a.createElement(V.a,{fill:"#fff",width:14,height:14}))},"\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u043f\u0435\u0432\u043a\u0430 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u043c\u0430\u043d\u0438\u0432\u0430\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442\u044f\u0433");this.setState({popout:o.a.createElement(m.a,{actions:[{title:"\u041e\u0442\u043c\u0435\u043d\u0430",autoclose:!0,mode:"cancel"},{title:"\u041f\u0435\u0440\u0435\u043a\u0443\u043f\u0438\u0442\u044c",autoclose:!0,action:function(){e.state.userData.warPoints-e.state.points[e.state.activeTab].value>=0?e.setState({snackbar:t}):e.setState({snackbar:a})}}],onClose:function(){e.setState({popout:null})}},o.a.createElement("h2",null,"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435"),o.a.createElement("p",null,"\u041f\u0435\u0440\u0435\u043a\u0443\u043f\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u044f\u0433 \u0437\u0430 ",this.state.points[this.state.activeTab].value," \u043f\u0438\u0432\u0430."))})}},{key:"openPanel",value:function(e){this.setState({activePanel:e})}},{key:"openView",value:function(e){this.setState({activeView:e})}},{key:"markerClick",value:function(e,t,a){var n=this;if("\u0421\u043a\u043b\u0430\u0434 \u043f\u0435\u0432\u043a\u0430"===e.name)return alert("\u0421\u043e\u0431\u0440\u0430\u043d\u043e \u043f\u0435\u0432\u043a\u0430"),0;S()("#layout").addClass("active"),C.a.send("VKWebAppGetUserInfo",{}).then((function(t){return n.setState({activeTab:e.num,activeTabOwner:t})}))}},{key:"removeIcons",value:function(e,t){t.setOptions({styles:[{elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",stylers:[{visibility:"off"}]}]})}},{key:"openCaptureModal",value:function(e){}},{key:"render",value:function(){return o.a.createElement(m.f,{activeView:this.state.activeView},o.a.createElement(m.i,{popout:this.state.popout,id:"main",activePanel:this.state.activePanel},o.a.createElement(m.d,{id:"main"},o.a.createElement(m.e,null,"\u0412\u041e\u0419\u041d\u0410 \u0417\u0410 \u0418\u041d\u041e\u0420\u0421"),o.a.createElement(M,{removeIcons:this.removeIcons,google:this.props.google,points:this.state.points,markerClick:this.markerClick}),o.a.createElement(A,{owner:this.state.activeTabOwner,buy:this.kupitRabotyag,data:this.state.points[this.state.activeTab]}),this.state.snackbar)))}}]),a}(o.a.Component),G=Object(_.GoogleApiWrapper)({apiKey:"AIzaSyC2L8vPYtDn5Csq-7Gj9sZqSzvb3Bx1QfI"})(U);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},24:function(e,t,a){e.exports=a.p+"static/media/pv.910d5316.png"},34:function(e,t,a){e.exports=a.p+"static/media/wh.59a4c6da.png"}},[[113,1,2]]]);
//# sourceMappingURL=main.96c4fe4e.chunk.js.map